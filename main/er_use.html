<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CMSIS-View: Using Event Recorder</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="footer.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="cmsis_logo_white_small.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">CMSIS-View
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown(this);
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">Record program events, display status information, and analyze execution faults</div>
  </td>
  <!--END !PROJECT_NAME-->
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('er_use.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Using Event Recorder </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>The following steps explain how to enable views for static information <em>and</em> dynamic events in the µVision debugger. Other tools might use different ways to accomplish this.</dd></dl>
<p><b>For User Code:</b></p><ol type="1">
<li><a class="el" href="er_use.html#Add_Event_Recorder">Add Event Recorder Component</a>.</li>
<li>[Optional] <a class="el" href="er_use.html#place_uninit_memory">Locate the Event Recorder data to uninitialized memory</a> to avoid overwriting the entries on program reset.</li>
<li>[Optional] Set the correct <a class="el" href="er_use.html#initial_timestamp">initial time stamp</a>.</li>
<li>[Optional] Create a <a class="el" href="er_use.html#heartbeat">heartbeat</a> to avoid timer overflow problems.</li>
<li>Add <a class="el" href="er_use.html#Event_Annotations">Event Annotations</a> in the C source to be able to stream dynamic event information.</li>
<li>Create an <a class="el" href="SCVD_Format.html">SCVD file</a> to <a class="el" href="er_use.html#Format_Event_Information">Format Event Information</a> that matches with application code.</li>
</ol>
<p ><b>For Pre-annotated Software Components:</b></p>
<p >The software packs for MDK-Middleware, CMSIS, CMSIS-FreeRTOS already contain the relevant *.SCVD files and the related event annotations in the C source code.</p>
<ol type="1">
<li><a class="el" href="er_use.html#Add_Event_Recorder">Add Event Recorder Component</a> to the project.</li>
<li>Select a <a class="el" href="er_use.html#Debug_Variants">Debug</a> variant for the middleware component to enable event information (for RTX5 select <b>Source</b> variant).</li>
</ol>
<h1><a class="anchor" id="Add_Event_Recorder"></a>
Add Event Recorder Component</h1>
<p >To use the Event Recorder in an application, you need to:</p><ul>
<li>Select the software component <b>CMSIS-View:Event Recorder</b> using the RTE management dialog.<br  />
 <img src="SelEventRecorder.png" alt="" class="inline" title="Select Event Recorder"/> <dl class="section note"><dt>Note</dt><dd>Usually, you select the <b>DAP</b> variant. If you are using a simulation model (FastModel or Arm Virtual Hardware), you can select <a class="el" href="er_use.html#er_semihosting">Semihosting</a> to write the Event Recorder data into a file on the PC.</dd></dl>
</li>
<li>Include the EventRecorder.h header file and add the event recorder initialization function to the source code: <div class="fragment"><div class="line">  :</div>
<div class="line"><span class="preprocessor">#include &quot;EventRecorder.h&quot;</span>                        <span class="comment">// ARM::CMSIS-View:Event Recorder</span></div>
<div class="line">  :</div>
<div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>) {</div>
<div class="line">  :</div>
<div class="line">  HAL_Init();                                     <span class="comment">// configure hardware abstraction layer</span></div>
<div class="line">  SystemClock_Config();                           <span class="comment">// configure system clock</span></div>
<div class="line">  MemoryBus_Config();                             <span class="comment">// configure external memory bus</span></div>
<div class="line">  <a class="code hl_function" href="group__EventRecorder__Setup.html#gac5369fe03bdcb771bacb25d7734a5f23">EventRecorderInitialize</a> (<a class="code hl_define" href="group__EventRecorder__recdefs.html#ga974d33703cba889a6597cb7e6f7a1a49" title="Record events with any level.">EventRecordAll</a>, 1);    <span class="comment">// initialize and start Event Recorder</span></div>
<div class="line">  :</div>
<div class="line">  <span class="comment">// other application code</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>By default, the Event Recorder uses the DWT Cycle Counter as a time stamp source. This is not available on Cortex-M0/M0+/M23. Change the <a class="el" href="er_theory.html#er_config">configuration</a> to use an alternative timer instead.</li>
<li>For Keil RTX5 (version 5.4.0 and above), no call to <a class="el" href="group__EventRecorder__Setup.html#gac5369fe03bdcb771bacb25d7734a5f23">EventRecorderInitialize</a> is required. Instead enable <b>Event Recorder Configuration - Global Initialization</b> in the RTX_Config.h file. Refer to the <a href="https://arm-software.github.io/CMSIS_5/RTOS2/html/rtx5_impl.html" target="_blank">CMSIS-RTOS2 - RTX v5 Implementation</a> for more information.</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="place_uninit_memory"></a>
Locate Event Recorder in uninitialized memory</h1>
<p >For uninterrupted recording of program resets, the RAM for the Event Recorder component should be placed to a memory region that is not cleared (or initialized) by a system restart (reset).</p>
<dl class="section note"><dt>Note</dt><dd>Make sure that you use normal, non-cacheable, and non-shareable memory for Event Recorder data.</dd></dl>
<h2><a class="anchor" id="evr_memory_calc"></a>
Calculate memory requirements</h2>
<p >The memory required for the Event Recorder data is calculated with the formula: </p><div class="fragment"><div class="line">164 + 16 x Number_of_Records (defined by EVENT_RECORD_COUNT in EventRecorderConf.h)</div>
</div><!-- fragment --><p> In this example we configure <code>0x800</code> bytes (as it is easier) which can hold more than 64 records.</p>
<h2><a class="anchor" id="evr_create_mem"></a>
Create memory region</h2>
<p >To setup this uninitialized RAM, use either <a class="el" href="er_use.html#evr_create_mem_ls">Create memory region using linker script</a> or <a class="el" href="er_use.html#evr_create_mem_uv">Create memory region using µVision</a> procedure.</p>
<h3><a class="anchor" id="evr_create_mem_ls"></a>
Create memory region using linker script</h3>
<p >If the linker script does not contain provisions for uninitialized memory section then, for respective toolchain, add the necessary section like described below:</p>
<h4><a class="anchor" id="evr_create_mem_ls_ac"></a>
Arm Compiler</h4>
<p >for the <b>Arm Compiler</b> toolchain add the following code snippet to the linker script (.sct file), in the part specifying RAM sections (usually before Heap section):</p>
<div class="fragment"><div class="line">RW_NOINIT &lt;start_address&gt; UNINIT 0x800 {</div>
<div class="line">  * (.bss.noinit*)</div>
<div class="line">}</div>
</div><!-- fragment --><blockquote class="doxtable">
<p >Note: &lt;start_address&gt; is the physical address in RAM where the section will start </p>
</blockquote>
<blockquote class="doxtable">
<p >Note: 0x800 is the size of the section, adjust that as necessary </p>
</blockquote>
<p><br  />
 </p>
<h4><a class="anchor" id="evr_create_mem_ls_gcc"></a>
GCC</h4>
<p >for the <b>GCC</b> toolchain add the following code snippet to the linker script (.ld file), in the part specifying RAM sections (usually before Heap section):</p>
<div class="fragment"><div class="line">.noinit (NOLOAD) :</div>
<div class="line">{</div>
<div class="line">  . = ALIGN(4);</div>
<div class="line">  PROVIDE (__noinit_start = .);</div>
<div class="line">  *(.noinit*)</div>
<div class="line">  . = ALIGN(4);</div>
<div class="line">  PROVIDE (__noinit_end = .);</div>
<div class="line">} &gt; RAM</div>
</div><!-- fragment --><blockquote class="doxtable">
<p >Note: this code snippet expects defined RAM memory region, if RAM region is not defined then adapt the script accordingly </p>
</blockquote>
<h2><a class="anchor" id="evr_create_mem_uv"></a>
Create memory region using µVision</h2>
<p >To setup this uninitialized RAM in the µVision, follow the steps below:</p>
<ol type="1">
<li>In the <b>Options for Target</b> dialog, on the <b>Utilities</b> tab, click on <b>Settings</b> for "Use Target Driver for Flash Programming". Note the "RAM for Algorithm" area:<br  />
 <img src="ram_for_algorithm_area.png" alt="" class="inline" title="RAM for Algorithm""/></li>
<li>In the <b>Options for Target</b> dialog, define a Read/Write memory area that is not initialized and which does not overlap with the area from the first step.<br  />
 For example, split IRAM1 into two regions. Reduce size of IRAM1 by 0x800 and create an IRAM2 area with start 0x2001F800 and size 0x800. Enable <b>NoInit</b> for this IRAM2 region.<br  />
 <img src="create_iram2.png" alt="" class="inline" title="Create RAM area"/></li>
<li>In the <b>Options for Component Class 'CMSIS-View'</b> dialog (opens with right-click on <b>EventRecorder.c</b> in the <b>Project</b> window), on the <b>Memory</b> tab, assign <b>Zero Initialized Data</b> to the IRAM2 region. <img src="er_memory_location.png" alt="" class="inline" title="Create RAM area"/></li>
<li>Build the application to place the Event Recorder data buffers to uninitialized RAM. You may verify the generated scatter file: <div class="fragment"><div class="line">; *************************************************************</div>
<div class="line">; *** Scatter-Loading Description File generated by uVision ***</div>
<div class="line">; *************************************************************</div>
<div class="line"> </div>
<div class="line">LR_IROM1 0x00000000 0x00040000  {    ; load region size_region</div>
<div class="line">  ER_IROM1 0x00000000 0x00040000  {  ; load address = execution address</div>
<div class="line">   *.o (RESET, +First)</div>
<div class="line">   *(InRoot$$Sections)</div>
<div class="line">   .ANY (+RO)</div>
<div class="line">  }</div>
<div class="line">  RW_IRAM1 0x20000000 0x0001F800  {  ; RW data</div>
<div class="line">   .ANY (+RW +ZI)</div>
<div class="line">  }</div>
<div class="line">  RW_IRAM2 0x2001F800 UNINIT 0x00000800  {</div>
<div class="line">    EventRecorder.o (+ZI)</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ol>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>If the Event Recorder data buffer is not in uninitialized memory, the <b>Command</b> window of the debugger displays: "Warning: Event Recorder not located in uninitialized memory!".</li>
<li><a href="https://developer.arm.com/documentation/ka003868/latest" target="_blank">Knowledgebase article 4012</a> explains how to create custom memory areas in uVision.</li>
<li>If your RAM is not big enough to separate the Event Recorder area from the Flash programming area, make sure that you enable "Reset and Run" for the <b>Download Function</b>: <div class="image">
<img src="reset_and_run.png" alt=""/>
</div>
</li>
<li>If this still produces broken Event Recorder records after a reset, a power-cycle of the target system will help.</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="initial_timestamp"></a>
Time Stamp Settings</h1>
<p >To avoid display problems in System Analyzer, set the <b>Time Stamp Clock Frequency [Hz]</b> to the initially expected value:</p>
<p ><img src="config_wizard.png" alt="" class="inline" title="Event Recorder Configuration Wizard"/></p>
<h1><a class="anchor" id="heartbeat"></a>
Event Recorder heartbeat</h1>
<p >The Event Recorder timer is a 32-bit counter that can overflow. To avoid overflow problems, send a "heartbeat" event within the limits of this 32-bit counter.</p>
<p ><b>Calculation Example</b></p>
<p >Assuming that your application is running at 168 MHz, you can calculate the time between two heartbeats like the following: </p><div class="fragment"><div class="line">2^32 / 168000000 Hz = 25.57 s</div>
</div><!-- fragment --><p> So you need to generate an event every 25 s. This can be an event with an event ID that you don't need and thus filter from the display in Event Recorder or an event that you use to check if your application is still running.</p>
<h1><a class="anchor" id="Event_Annotations"></a>
Event Annotations</h1>
<p >To to stream dynamic event information, insert calls to the <a class="el" href="group__EventRecorder__Data.html">Event Data Recording</a> functions on relevant code locations:</p><ul>
<li><a class="el" href="group__EventRecorder__Data.html#ga48793c095f887522be941c7b8179dd0a">EventRecordData</a> to record a data field with flexible length.</li>
<li><a class="el" href="group__EventRecorder__Data.html#gab91eb760432ad0a10652a2c922db9566">EventRecord2</a> to record up to two 32-bit integer values.</li>
<li><a class="el" href="group__EventRecorder__Data.html#ga1807e8d9b62b51f862a3d3fe36e611f8">EventRecord4</a> to record up to four 32-bit integer values.</li>
</ul>
<p >These <a class="el" href="group__EventRecorder__Data.html">Event Data Recording</a> functions receive as first parameter an <em>id</em> event identifier used for filtering and displaying. The macro <a class="el" href="group__EventRecorder__Data.html#ga44fa52e2007e535753fd4ba59b84d55d">EventID</a> may be used to compose <em>id</em> values to include <em>level</em> and <em>component</em> numbers.</p>
<p ><b>Example:</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;EventRecorder.h&quot;</span>                       <span class="comment">// ARM::CMSIS-View:Event Recorder</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> some_error = 0;                              <span class="comment">// error flag</span></div>
<div class="line"><span class="keywordtype">char</span> <span class="keywordtype">string</span>[10] = <span class="stringliteral">&quot;MyTest&quot;</span>;                      <span class="comment">// some test string</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MyFunction (<span class="keywordtype">int</span> parameter) {</div>
<div class="line">  <a class="code hl_function" href="group__EventRecorder__Data.html#gab91eb760432ad0a10652a2c922db9566">EventRecord2</a> (1+<a class="code hl_define" href="group__EventRecorder__leveldefs.html#ga804697e938a79b0ea388872951ed7b06" title="API function call.">EventLevelAPI</a>, parameter, 0);              <span class="comment">// Event at Start</span></div>
<div class="line">    ;</div>
<div class="line">  <span class="keywordflow">if</span> (some_error)  {</div>
<div class="line">    <a class="code hl_function" href="group__EventRecorder__Data.html#gab91eb760432ad0a10652a2c922db9566">EventRecord2</a> (2+<a class="code hl_define" href="group__EventRecorder__leveldefs.html#ga09458e6018228f12b87671342e77545c" title="Run-time error in the component.">EventLevelError</a>, 0, 0);                  <span class="comment">// Event at Error</span></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_function" href="group__EventRecorder__Data.html#ga48793c095f887522be941c7b8179dd0a">EventRecordData</a> (3+<a class="code hl_define" href="group__EventRecorder__leveldefs.html#ga45955a55988126e124b2c6595812c9f4" title="Internal operation.">EventLevelOp</a>, <span class="keywordtype">string</span>, <span class="keyword">sizeof</span>(<span class="keywordtype">string</span>));  <span class="comment">// Event at Finish</span></div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code hl_function" href="group__EventRecorder__Setup.html#gac5369fe03bdcb771bacb25d7734a5f23">EventRecorderInitialize</a> (<a class="code hl_define" href="group__EventRecorder__recdefs.html#ga974d33703cba889a6597cb7e6f7a1a49" title="Record events with any level.">EventRecordAll</a>, 1);  <span class="comment">// initialize and start Event Recorder</span></div>
<div class="line"> </div>
<div class="line">  MyFunction (0x10);</div>
<div class="line">  some_error = 1;                               <span class="comment">// set error flag</span></div>
<div class="line">  MyFunction (0x60);</div>
<div class="line">}</div>
</div><!-- fragment --><p >When executing this example in the µVision debugger, use the menu command <b>View - Analysis Windows - Event Recorder</b> to open the Event Recorder window. This should show the following output:</p>
<p ><img src="EventOutput1.png" alt="" class="inline" title="Output shown in Event Recorder window"/></p>
<h1><a class="anchor" id="Format_Event_Information"></a>
Format Event Information</h1>
<p >You may create an <a class="el" href="SCVD_Format.html">*.SCVD (Software Component View Description) file</a> to format the event output so that matches the application. The event output is created using the <a class="el" href="elem_events.html">/component_viewer/events</a>.</p>
<p ><b>SCVD file example</b> </p><div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">component_viewer</span> <span class="keyword">schemaVersion</span>=<span class="stringliteral">&quot;0.1&quot;</span> <span class="keyword">xmlns:xs</span>=<span class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="keyword">xs:noNamespaceSchemaLocation</span>=<span class="stringliteral">&quot;Component_Viewer.xsd&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">component</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MyExample&quot;</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0.0&quot;</span>/&gt;    <span class="comment">&lt;!-- name and version of the component  --&gt;</span></div>
<div class="line"> </div>
<div class="line">    &lt;<span class="keywordtype">events</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">group</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;My Events Group&quot;</span>&gt;</div>
<div class="line">         &lt;<span class="keywordtype">component</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MyApp&quot;</span>      <span class="keyword">brief</span>=<span class="stringliteral">&quot;My Application&quot;</span>    <span class="keyword">no</span>=<span class="stringliteral">&quot;0x00&quot;</span> <span class="keyword">prefix</span>=<span class="stringliteral">&quot;EvrNetMM_&quot;</span>    <span class="keyword">info</span>=<span class="stringliteral">&quot;Network - System - Dynamic Memory Management&quot;</span>/&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">group</span>&gt;</div>
<div class="line"> </div>
<div class="line">      &lt;<span class="keywordtype">event</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">level</span>=<span class="stringliteral">&quot;API&quot;</span>   <span class="keyword">property</span>=<span class="stringliteral">&quot;MyFunction&quot;</span>        <span class="keyword">value</span>=<span class="stringliteral">&quot;parameter=%x[val1]&quot;</span>     <span class="keyword">info</span>=<span class="stringliteral">&quot;Event on start of MyFunction&quot;</span>  /&gt;</div>
<div class="line">      &lt;<span class="keywordtype">event</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">level</span>=<span class="stringliteral">&quot;Error&quot;</span> <span class="keyword">property</span>=<span class="stringliteral">&quot;MyFunctionError&quot;</span>                                  <span class="keyword">info</span>=<span class="stringliteral">&quot;Event on error in MyFunction&quot;</span> /&gt;</div>
<div class="line">      &lt;<span class="keywordtype">event</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">level</span>=<span class="stringliteral">&quot;Op&quot;</span>    <span class="keyword">property</span>=<span class="stringliteral">&quot;MyFunctionProcess&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;string=%t[val1]&quot;</span>        <span class="keyword">info</span>=<span class="stringliteral">&quot;Event on operation in MyFunction&quot;</span>  /&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">events</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;/<span class="keywordtype">component_viewer</span>&gt;</div>
</div><!-- fragment --><p >In the µVision debugger, this <a class="el" href="SCVD_Format.html">*.SCVD file</a> is specified in the dialog <b>Options for Target - Debug - Manage Component Viewer Description Files</b>. Click on <b>Add Component Viewer Description File</b> and add the related *.SCVD file.</p>
<p ><img src="Manage_SCVD_Files.png" alt="" class="inline" title="Manage *.SCVD files"/></p>
<p >The Event Recorder displays the events as shown below.</p>
<p ><img src="EventOutput2.png" alt="" class="inline" title="Event Recorder output formatted with *.SCVD file"/></p>
<p >The described groups and events also show up in the filter dialog.</p>
<p ><img src="EventRecorderFilter.png" alt="" class="inline" title="Event Recorder Filter dialog"/></p>
<h1><a class="anchor" id="Debug_Variants"></a>
Software Component Variants</h1>
<p >The software packs for MDK-Middleware and CMSIS already contain SCVD files that match the related event annotations in the C source code. However, you need to select the right component <b>Variant</b>. For MDK-Middleware, you need to select the <b>Debug</b> variants, whereas for Keil RTX5, you need to add the <b>Source</b> variant.</p>
<p >The example below enables event recording for the MDK-Middleware <b>File System</b> component:</p>
<p ><img src="SelSWComp.png" alt="" class="inline" title="Select debug variant"/></p>
<h1><a class="anchor" id="printf_redirect"></a>
Redirecting printf output</h1>
<p >The Event Recorder can be used to retarget printf output. This is especially interesting for targets without ITM, such as Cortex-M0/M0+/M23. Steps to enable this:</p><ol type="1">
<li>In the Manage Run-Time Environment window, set the component <b>CMSIS-Compiler:I/O:STDOUT</b> to use <b>Variant</b> <em>EVR</em>.</li>
<li>Select the component <b>CMSIS-View:Event Recorder</b> or use the <b>Resolve</b> button.</li>
<li>In the user code, include <em>EventRecorder.h</em> and call the <code><a class="el" href="group__EventRecorder__Setup.html#gac5369fe03bdcb771bacb25d7734a5f23">EventRecorderInitialize()</a></code> function in <code>main()</code>.</li>
</ol>
<p >Refer to the example <a href="https://arm-software.github.io/CMSIS-Compiler/latest/Retarget_Examples_er.html">Retarget STDOUT via Event Recorder</a>.</p>
<h1><a class="anchor" id="er_filtering"></a>
Event filtering</h1>
<p >Filtering for events reduces the amount of data transmitted from the target to the debugger. To filter for events, use the button <b>Configure Target Event Recording</b>:</p>
<div class="image">
<img src="filter_button.png" alt=""/>
</div>
<p >A new window opens up that lets you filter for events that you are interested in:</p>
<p ><img src="filtering_events.png" alt="" class="inline" title="Filtering events"/></p>
<h1><a class="anchor" id="er_semihosting"></a>
Semihosting</h1>
<p >Semihosting is a mechanism that enables code running on an Arm target to communicate and use the input/output facilities on a host computer that is running a debugger.</p>
<p >Examples of these facilities include keyboard input, screen output, and disk I/O. For example, you can use this mechanism to enable functions in the C library, such as <code>printf</code> and <code>scanf</code>, to use the screen and keyboard of the host instead of having a screen and keyboard on the target system.</p>
<p >With the Event Recorder, you can use semihosting with models to write the events into a file on your PC. This works with <a href="https://developer.arm.com/Tools%20and%20Software/Fast%20Models">Arm Fast Models</a>, <a href="https://developer.arm.com/Tools%20and%20Software/Fixed%20Virtual%20Platforms">Arm Fixed Virtual Platforms</a>, and <a href="https://www.arm.com/products/development-tools/simulation/virtual-hardware">Arm Virtual Hardware</a> alike.</p>
<p >The file that is written is called <em>EventRecorder.log</em> and is a binary file that is available in the root directory of your project. Use <a class="el" href="evntlst.html">eventlist</a> to read and decode the binary data.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Your model needs to be configured for semihosting (refer to the documentation of your modeling technology on how to do that).</li>
<li>You can specify a different name for the log file by specifying a define called <code>EVENT_LOG_FILENAME</code>.</li>
<li>In µVision, once you start a new debug session, the log file will be overwritten. While in debug, new messages will be appended to the currently open log file.</li>
<li>In µVision, the semihosting variant will not work with real target hardware. Instead, program execution will hit a breakpoint and stop there.</li>
<li>In µVision, you can still use the Event Recorder window in µVision to see the events coming in while the file is written to the hard drive of your PC. </li>
</ul>
</dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
